(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[566],{2450:(e,t,a)=>{"use strict";a.d(t,{F:()=>s.F});var s=a(2450)},6135:(e,t,a)=>{Promise.resolve().then(a.bind(a,9118))},9118:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b,dynamic:()=>m});var s=a(5155),r=a(3122),l=a(499),n=a(2450),d=a(63),i=a(2115);let o=[{id:"student",label:"Student",description:"Access classes, attendance, and campus services",icon:"\uD83C\uDF93"},{id:"faculty",label:"Faculty",description:"Manage classes, attendance, and student records",icon:"\uD83D\uDC68‍\uD83C\uDFEB"},{id:"admin",label:"Admin",description:"Full system access and management",icon:"\uD83D\uDD27"},{id:"hostelAdmin",label:"Hostel Admin",description:"Manage hostel operations and meals",icon:"\uD83C\uDFE0"},{id:"canteenAdmin",label:"Canteen Admin",description:"Manage canteen menu and orders",icon:"\uD83C\uDF7D️"}];function c(e){let{value:t,onChange:a}=e;return(0,s.jsx)("div",{className:"space-y-2",children:o.map(e=>(0,s.jsx)("button",{type:"button",onClick:()=>a(e.id),className:"w-full p-4 rounded-xl text-left transition-all ".concat(t===e.id?"bg-primary-100 dark:bg-primary-900/30 border-2 border-primary-500 dark:border-primary-400":"bg-white dark:bg-slate-800 border-2 border-transparent hover:border-slate-200 dark:hover:border-slate-700"),children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("span",{className:"text-2xl",children:e.icon}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-semibold text-slate-900 dark:text-white",children:e.label}),t===e.id&&(0,s.jsx)("span",{className:"text-primary-600 dark:text-primary-400",children:"✓"})]}),(0,s.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-400 mt-0.5",children:e.description})]})]})},e.id))})}let m="force-dynamic",u=["Computer Science","Electronics","Mechanical","Civil","Electrical","Chemical","Biotechnology","Information Technology"],x=[1,2,3,4];function b(){let{user:e,isLoaded:t}=(0,r.Jd)(),a=(0,d.useRouter)(),o=(0,l.n_)(n.F.users.createOrUpdateUser),m=(0,l.IT)(n.F.users.getUser,(null==e?void 0:e.id)?{clerkUserId:e.id}:"skip"),[b,p]=(0,i.useState)(""),[h,f]=(0,i.useState)(""),[g,v]=(0,i.useState)(1),[y,k]=(0,i.useState)(""),[j,N]=(0,i.useState)(!1),[w,C]=(0,i.useState)("");if((0,i.useEffect)(()=>{(null==m?void 0:m.role)&&a.push("/")},[m,a]),(0,i.useEffect)(()=>{var t;(null==e||null==(t=e.unsafeMetadata)?void 0:t.role)&&p(e.unsafeMetadata.role)},[e]),!t)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});if(!e)return a.push("/sign-in"),null;let S=async t=>{if(t.preventDefault(),C(""),!b)return void C("Please select a role");if("student"===b&&(!h||!g))return void C("Please select your branch and year");N(!0);try{var s,r,l,n;await o({clerkUserId:e.id,email:null!=(r=null==(s=e.emailAddresses[0])?void 0:s.emailAddress)?r:"",name:null!=(n=null!=(l=e.fullName)?l:e.username)?n:"",role:b,branch:"student"===b?h:void 0,year:"student"===b?g:void 0,phone:y||void 0}),await e.update({unsafeMetadata:{role:b,onboardingComplete:!0}}),a.push("/")}catch(e){C("Failed to complete onboarding. Please try again."),console.error(e)}finally{N(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-900 p-4",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto py-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Complete Your Profile"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-2",children:"Tell us a bit about yourself"})]}),(0,s.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"I am a"}),(0,s.jsx)(c,{value:b,onChange:p})]}),"student"===b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Branch"}),(0,s.jsxs)("select",{value:h,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Select your branch"}),u.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Year"}),(0,s.jsx)("div",{className:"flex gap-2",children:x.map(e=>(0,s.jsxs)("button",{type:"button",onClick:()=>v(e),className:"flex-1 py-2 rounded-lg font-medium transition-colors ".concat(g===e?"bg-primary-600 text-white":"bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-300 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700"),children:["Year ",e]},e))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Phone Number (optional)"}),(0,s.jsx)("input",{type:"tel",value:y,onChange:e=>k(e.target.value),placeholder:"+91 9876543210",className:"w-full px-4 py-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),w&&(0,s.jsx)("div",{className:"p-3 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm",children:w}),(0,s.jsx)("button",{type:"submit",disabled:j,className:"w-full py-3 px-4 rounded-lg bg-primary-600 text-white font-medium hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?"Completing...":"Complete Setup"})]})]})})}}},e=>{e.O(0,[659,499,441,255,358],()=>e(e.s=6135)),_N_E=e.O()}]);